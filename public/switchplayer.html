<!DOCTYPE html>
<html>

  <head>
    <title>Resistance</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="stylesheets/style.css">
   <script src="vote.js"></script>
    <script language="javascript" type="text/javascript">	
		/*eslint-env browser, jquery*/
		function getNextPlayer() {
			var roomNum = sessionStorage.getItem("roomNum");
			var player = sessionStorage.getItem("currentNum");
			if(player === null || player === "") 
				player = -1;
			player++;
			player = 0;
    	/*	$.get( "/" + roomNum + "/whoMission", function( data ) {
				var str = "Pass the phone to " + data[player].name;
				document.getElementById("par").innerHTML = str;
			});
		*/
			//build player table
			var xhr = new XMLHttpRequest();
			xhr.open('GET', "/" + roomNum + "/whoMission", true);
			xhr.send();
			xhr.onreadystatechange = processRequest;
			function processRequest(data) {
				if(xhr.readyState === 4 && xhr.status === 200) {
					var str = "Pass the phone to " + xhr.response[player].name;
					document.getElementById("par").innerHTML = str;
				}
			}
			//update for next player
			sessionStorage.setItem("currentNum", player);
    	}
    	function switchPageMission() {
    		window.location.href="mission.html";
    	}
    </script>
  </head>

  <body onload="getNextPlayer()">
    <table>
      <tr>
            <h2 id="par"></h2>
            <div name="buttons">
            	<button type="button" id="next" onclick="switchPageMission()">I certify that I am in fact this person</button>
            </div>
       </tr>
    </table>
  </body>
</html>
